#!/usr/bin/env ruby
require 'colorize'

game_over = false
player = {
  :name => '',
  :inventory => [],
}
puts 'What is your name?'.yellow
player[:name] = gets.chomp

greeting = "Welcome to the adventure #{player[:name].light_black}..."
puts '='.black * greeting.length
puts greeting.black
puts '='.black * greeting.length
puts

while not game_over do
  # wait for player action
  puts 'What do you want to do?'.yellow
  action = gets.chomp

  # react to action
  case action
  when 'win'
    game_over = true
    puts
    puts 'Congratulations! You win!'.green
    puts
  when 'look'
    puts
    puts 'You are in a room containing a (1)safe and a (2)key.'.blue
    puts
  when /take \d+/
    thing = action.match(/take (\d+)/).captures.first
    puts
    puts "Added (#{thing}) to your inventory".light_green
    puts
  when /open \d+/
    thing = action.match(/open (\d+)/).captures.first
    puts
    puts "(#{thing}) requires key".light_red
    puts
  when /help|\?/
    puts
    puts 'Here are the things you can do:'.light_cyan
    puts '  look - describe surroundings'.light_cyan
    puts '  take <thing> - remove thing from place and add to inventory'.light_cyan
    puts '  open <thing> - opens an openable thing'.light_cyan
    puts '  help or ? - print this message'.light_cyan
    puts
  else
    puts "#{action} is an invalid action".red
    puts 'run help or ? for a list of available actions'.light_red
    puts
  end
end
